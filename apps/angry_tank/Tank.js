function Tank(e,t){this.world=e,baseSize=t,this.body=this.CreateBody(),this.head=this.CreateHead(),this.left_wheel=this.CreateWheel(35),this.middle_wheel=this.CreateWheel(0),this.right_wheel=this.CreateWheel(-35),this.left_motor=this.CreateMotor(this.left_wheel),this.middle_motor=this.CreateMotor(this.middle_wheel),this.right_motor=this.CreateMotor(this.right_wheel),this.left_motor_added=this.world.CreateJoint(this.left_motor),this.middle_motor_added=this.world.CreateJoint(this.middle_motor),this.right_motor_added=this.world.CreateJoint(this.right_motor),this.gun=this.CreateGun(),this.gun_joint=null,this.gun_joint_def=null,this.InitJoint()}Tank.prototype.InitJoint=function(){t=new b2WeldJointDef;var e=this.body.GetPosition();t.Initialize(this.body,this.head,new b2Vec2(e.x-50/baseSize,e.y)),this.world.CreateJoint(t);var t=new b2RevoluteJointDef,i=new b2Vec2(this.head.GetWorldCenter().x+25/baseSize,this.head.GetWorldCenter().y);t.Initialize(this.gun,this.head,i),t.enableLimit=!0,t.referenceAngle=20*Math.PI/180,this.gun_joint_def=t,this.gun_joint=this.world.CreateJoint(t)},Tank.prototype.CreateBody=function(){var e=new b2BodyDef;e.position.Set(250/baseSize,379/baseSize),e.type=b2Body.b2_dynamicBody;var t=this.world.CreateBody(e);return fixDef.filter.groupIndex=1,fixDef.shape=new b2PolygonShape,fixDef.shape.SetAsBox(50/baseSize,10/baseSize),t.CreateFixture(fixDef),t},Tank.prototype.CreateHead=function(){var e=new b2BodyDef;e.position.Set(240/baseSize,360/baseSize),e.type=b2Body.b2_dynamicBody;var t=this.world.CreateBody(e);return fixDef.filter.groupIndex=-2,fixDef.shape=new b2PolygonShape,fixDef.shape.SetAsBox(30/baseSize,8/baseSize),t.CreateFixture(fixDef),t},Tank.prototype.CreateWheel=function(e){var t=new b2BodyDef;t.type=b2Body.b2_dynamicBody,fixDef.shape=new b2CircleShape(10.5/baseSize),fixDef.friction=4,t.position.Set(this.body.GetWorldCenter().x+e/baseSize,this.body.GetWorldCenter().y+.1);var i=this.world.CreateBody(t);return i.CreateFixture(fixDef),i},Tank.prototype.CreateMotor=function(e){var t=new b2RevoluteJointDef;return t.enableMotor=!0,t.maxMotorTorque=10,t.Initialize(this.body,e,e.GetWorldCenter()),t},Tank.prototype.CreateGun=function(){var e=new b2BodyDef;e.position.Set(this.head.GetWorldCenter().x+55/baseSize,this.head.GetWorldCenter().y),e.type=b2Body.b2_dynamicBody;var t=this.world.CreateBody(e);return fixDef.filter.groupIndex=-2,fixDef.shape=new b2PolygonShape,fixDef.shape.SetAsBox(30/baseSize,3/baseSize),t.CreateFixture(fixDef),t},Tank.prototype.Run=function(e){this.right_motor_added.SetMotorSpeed(e),this.middle_motor_added.SetMotorSpeed(e),this.left_motor_added.SetMotorSpeed(e)},Tank.prototype.Stop=function(){this.Run(0)},Tank.prototype.RaiseGun=function(){var e=this.gun_joint_def.referenceAngle+15*Math.PI/180;e>=Math.PI/2&&(e=Math.PI/2),this.SetGunAngle(e)},Tank.prototype.LowerGun=function(){var e=this.gun_joint_def.referenceAngle-15*Math.PI/180;0>=e&&(e=0),this.SetGunAngle(e)},Tank.prototype.SetGunAngle=function(e){this.gun_joint_def.referenceAngle=e,this.world.DestroyJoint(this.gun_joint),this.gun_joint=this.world.CreateJoint(this.gun_joint_def)},Tank.prototype.CreateBullet=function(){var e=new b2BodyDef;e.userData="bullet",e.type=b2Body.b2_dynamicBody,e.bullet=!0,fixDef.shape=new b2CircleShape(4/baseSize),fixDef.friction=4,fixDef.density=2,fixDef.filter.groupIndex=1;var t=this.gun_joint.GetAnchorA();e.position=new b2Vec2(2*this.gun.GetPosition().x-t.x,2*this.gun.GetPosition().y-t.y);var i=this.world.CreateBody(e);i.CreateFixture(fixDef),i.ApplyImpulse(new b2Vec2(2*(this.gun.GetPosition().x-t.x),2*(this.gun.GetPosition().y-t.y)),t)};